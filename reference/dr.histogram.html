<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>A histogram of density ratio estimates — dr.histogram • densityratio</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A histogram of density ratio estimates — dr.histogram"><meta name="description" content="Creates a histogram of the density ratio estimates. Useful to understand the
distribution of estimated density ratios in each sample, or compare it among
samples. It is the default plotting method for density ratio objects."><meta property="og:description" content="Creates a histogram of the density ratio estimates. Useful to understand the
distribution of estimated density ratios in each sample, or compare it among
samples. It is the default plotting method for density ratio objects."><meta property="og:image" content="https://thomvolker.github.io/densityratio/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">densityratio</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/densityratio.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/covariate-shift.html">Covariate shift adjustment</a></li>
    <li><a class="dropdown-item" href="../articles/high-dim-testing.html">High dimensional two-sample testing</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>A histogram of density ratio estimates</h1>

      <div class="d-none name"><code>dr.histogram.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a histogram of the density ratio estimates. Useful to understand the
distribution of estimated density ratios in each sample, or compare it among
samples. It is the default plotting method for density ratio objects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dr.histogram</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  samples <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  logscale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  binwidth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'ulsif'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  samples <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  logscale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  binwidth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'kliep'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  samples <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  logscale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  binwidth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'kmm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  samples <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  logscale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  binwidth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'spectral'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  samples <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  logscale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  binwidth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'lhss'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  samples <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  logscale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  binwidth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'naivedensityratio'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  samples <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  logscale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  binwidth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Density ratio object created with e.g., <code><a href="kliep.html">kliep()</a></code>, <code><a href="ulsif.html">ulsif()</a></code>,
or <code><a href="naive.html">naive()</a></code></p></dd>


<dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>Character string indicating whether to plot the 'numerator',
'denominator', or 'both' samples. Default is 'both'.</p></dd>


<dt id="arg-logscale">logscale<a class="anchor" aria-label="anchor" href="#arg-logscale"></a></dt>
<dd><p>Logical indicating whether to plot the density ratio
estimates on a log scale. Default is TRUE.</p></dd>


<dt id="arg-binwidth">binwidth<a class="anchor" aria-label="anchor" href="#arg-binwidth"></a></dt>
<dd><p>Numeric indicating the width of the bins, passed on to
<code>ggplot2</code>.</p></dd>


<dt id="arg-bins">bins<a class="anchor" aria-label="anchor" href="#arg-bins"></a></dt>
<dd><p>Numeric indicating the number of bins. Overriden by binwidth, and
passed on to <code>ggplot2</code>.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Numeric indicating the tolerance: values below this value will be set to the tolerance value, for legibility of the plots</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed on to <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A histogram of density ratio estimates.</p>
<p>A histogram of density ratio estimates.</p>
<p>A histogram of density ratio estimates.</p>
<p>A histogram of density ratio estimates.</p>
<p>A histogram of density ratio estimates.</p>
<p>A histogram of density ratio estimates.</p>
<p>A histogram of density ratio estimates.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Fit model</span></span></span>
<span class="r-in"><span><span class="va">dr</span> <span class="op">&lt;-</span> <span class="fu"><a href="ulsif.html">ulsif</a></span><span class="op">(</span><span class="va">numerator_small</span>, <span class="va">denominator_small</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Inspect model object</span></span></span>
<span class="r-in"><span><span class="va">dr</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ulsif(df_numerator = numerator_small, df_denominator = denominator_small)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kernel type: Gaussian with L2 norm distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of kernels: 150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sigma: num [1:10] 0.711 1.08 1.333 1.538 1.742 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization parameter (lambda): num [1:20] 1000 483.3 233.6 112.9 54.6 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal sigma (loocv): 1.538158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal lambda (loocv): 2.976351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal kernel weights (loocv): num [1:151] 0.0666 0.0289 0.0423 0.0442 0.0454 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span><span class="co"># Obtain summary of model object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ulsif(df_numerator = numerator_small, df_denominator = denominator_small)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kernel type: Gaussian with L2 norm distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of kernels: 150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal sigma: 1.538158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal lambda: 2.976351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal kernel weights: num [1:151] 0.0666 0.0289 0.0423 0.0442 0.0454 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pearson divergence between P(nu) and P(de): 0.3868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For a two-sample homogeneity test, use 'summary(x, test = TRUE)'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Plot model object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative estimated density ratios for 2 observation(s) converted to 0.01 before applying logarithmic transformation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="r-plt img"><img src="dr.histogram-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Plot density ratio for each variable individually</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_univariate.html">plot_univariate</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative estimated density ratios for 2 observation(s) converted to 0.01 before applying logarithmic transformation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="dr.histogram-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="dr.histogram-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-plt img"><img src="dr.histogram-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Plot density ratio for each pair of variables</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_bivariate.html">plot_bivariate</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative estimated density ratios for 2 observation(s) converted to 0.01 before applying logarithmic transformation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="dr.histogram-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="dr.histogram-6.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-plt img"><img src="dr.histogram-7.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Predict density ratio and inspect first 6 predictions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.9838195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 1.2872509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 1.5069634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 1.2804095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 1.0953012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 1.5262485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Fit model with custom parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ulsif.html">ulsif</a></span><span class="op">(</span><span class="va">numerator_small</span>, <span class="va">denominator_small</span>, sigma <span class="op">=</span> <span class="fl">2</span>, lambda <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ulsif(df_numerator = numerator_small, df_denominator = denominator_small,     sigma = 2, lambda = 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kernel type: Gaussian with L2 norm distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of kernels: 150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sigma: num 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization parameter (lambda): num 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal sigma (loocv): 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal lambda (loocv): 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal kernel weights (loocv): num [1:151] 0.0378 0.0348 0.0554 0.053 0.0619 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Fit model</span></span></span>
<span class="r-in"><span><span class="va">dr</span> <span class="op">&lt;-</span> <span class="fu"><a href="kliep.html">kliep</a></span><span class="op">(</span><span class="va">numerator_small</span>, <span class="va">denominator_small</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Inspect model object</span></span></span>
<span class="r-in"><span><span class="va">dr</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kliep(df_numerator = numerator_small, df_denominator = denominator_small)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kernel type: Gaussian with L2 norm distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of kernels: 150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sigma: num [1:10] 0.711 1.08 1.333 1.538 1.742 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal sigma (5-fold cv): 0.7105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal kernel weights (5-fold cv):  num [1:150, 1] 0.476 0.67 0.578 0.678 0.603 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Learning rate (epsilon): 1e+01  1e+00  1e-01  1e-02  1e-03  1e-04  1e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Maximum number of iterations:  5000</span>
<span class="r-in"><span><span class="co"># Obtain summary of model object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kliep(df_numerator = numerator_small, df_denominator = denominator_small)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kernel type: Gaussian with L2 norm distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of kernels: 150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal sigma: 0.7105233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal kernel weights: num [1:150, 1] 0.476 0.67 0.578 0.678 0.603 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kullback-Leibler divergence between P(nu) and P(de): 0.8268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For a two-sample homogeneity test, use 'summary(x, test = TRUE)'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Plot model object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative estimated density ratios for 16 observation(s) converted to 0.01 before applying logarithmic transformation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="r-plt img"><img src="dr.histogram-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Plot density ratio for each variable individually</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_univariate.html">plot_univariate</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative estimated density ratios for 16 observation(s) converted to 0.01 before applying logarithmic transformation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="dr.histogram-9.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="dr.histogram-10.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-plt img"><img src="dr.histogram-11.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Plot density ratio for each pair of variables</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_bivariate.html">plot_bivariate</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative estimated density ratios for 16 observation(s) converted to 0.01 before applying logarithmic transformation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="dr.histogram-12.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="dr.histogram-13.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-plt img"><img src="dr.histogram-14.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Predict density ratio and inspect first 6 predictions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.432706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 2.696996</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 3.600185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 2.715088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 2.219022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 2.930002</span>
<span class="r-in"><span><span class="co"># Fit model with custom parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="kliep.html">kliep</a></span><span class="op">(</span><span class="va">numerator_small</span>, <span class="va">denominator_small</span>,</span></span>
<span class="r-in"><span>      nsigma <span class="op">=</span> <span class="fl">1</span>, ncenters <span class="op">=</span> <span class="fl">100</span>, nfold <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>      epsilon <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">{</span><span class="fl">2</span><span class="op">:</span><span class="op">-</span><span class="fl">5</span><span class="op">}</span>, maxit <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kliep(df_numerator = numerator_small, df_denominator = denominator_small,     nsigma = 1, ncenters = 100, nfold = 10, epsilon = 10^{        2:-5    }, maxit = 500)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kernel type: Gaussian with L2 norm distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of kernels: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sigma: num 1.85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal sigma (10-fold cv): 1.852</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal kernel weights (10-fold cv):  num [1:100, 1] 0.039 0 0.0659 0 0.0786 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Learning rate (epsilon): 1e+02  1e+01  1e+00  1e-01  1e-02  1e-03  1e-04  1e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Maximum number of iterations:  500</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Fit model</span></span></span>
<span class="r-in"><span><span class="va">dr</span> <span class="op">&lt;-</span> <span class="fu"><a href="kmm.html">kmm</a></span><span class="op">(</span><span class="va">numerator_small</span>, <span class="va">denominator_small</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Inspect model object</span></span></span>
<span class="r-in"><span><span class="va">dr</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kmm(df_numerator = numerator_small, df_denominator = denominator_small)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kernel type: Gaussian with L2 norm distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of kernels: 150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sigma: num [1:10] 0.801 1.2 1.483 1.723 1.954 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal sigma (5-fold cv): 3.67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal kernel weights (5-fold cv):  num [1:150, 1] -0.104 -1.158 -0.83 4.116 5.019 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Optimization method:  Unconstrained </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Obtain summary of model object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kmm(df_numerator = numerator_small, df_denominator = denominator_small)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kernel type: Gaussian with L2 norm distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of kernels: 150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal sigma: 3.669758</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal kernel weights: num [1:150, 1] -0.104 -1.158 -0.83 4.116 5.019 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pearson divergence between P(nu) and P(de): 1.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For a two-sample homogeneity test, use 'summary(x, test = TRUE)'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Plot model object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative estimated density ratios for 23 observation(s) converted to 0.01 before applying logarithmic transformation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="r-plt img"><img src="dr.histogram-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Plot density ratio for each variable individually</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_univariate.html">plot_univariate</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative estimated density ratios for 23 observation(s) converted to 0.01 before applying logarithmic transformation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="dr.histogram-16.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="dr.histogram-17.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-plt img"><img src="dr.histogram-18.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Plot density ratio for each pair of variables</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_bivariate.html">plot_bivariate</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative estimated density ratios for 23 observation(s) converted to 0.01 before applying logarithmic transformation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="dr.histogram-19.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="dr.histogram-20.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-plt img"><img src="dr.histogram-21.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Predict density ratio and inspect first 6 predictions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 3.4223523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 3.8475792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 3.7279456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 5.8074734</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.9277723</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 1.6880096</span>
<span class="r-in"><span><span class="co"># Fit model with custom parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="kmm.html">kmm</a></span><span class="op">(</span><span class="va">numerator_small</span>, <span class="va">denominator_small</span>,</span></span>
<span class="r-in"><span>    nsigma <span class="op">=</span> <span class="fl">5</span>, ncenters <span class="op">=</span> <span class="fl">100</span>, nfold <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    constrained <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kmm(df_numerator = numerator_small, df_denominator = denominator_small,     constrained = TRUE, nsigma = 5, ncenters = 100, nfold = 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kernel type: Gaussian with L2 norm distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of kernels: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sigma: num [1:5] 0.811 1.577 2.094 2.66 3.706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal sigma (10-fold cv): 2.094</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal kernel weights (10-fold cv):  num [1:100, 1] -0.000498 -0.000999 -0.001187 -0.001022 -0.000275 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Optimization method:  Constrained </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Fit model</span></span></span>
<span class="r-in"><span><span class="va">dr</span> <span class="op">&lt;-</span> <span class="fu"><a href="spectral.html">spectral</a></span><span class="op">(</span><span class="va">numerator_small</span>, <span class="va">denominator_small</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Inspect model object</span></span></span>
<span class="r-in"><span><span class="va">dr</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spectral(df_numerator = numerator_small, df_denominator = denominator_small)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kernel type: Gaussian with L2 norm distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of kernels: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sigma: num [1:10] 0.807 1.191 1.455 1.688 1.913 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Subspace dimension (J): num [1:50] 1 2 4 6 8 10 11 13 15 17 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal sigma: 3.582214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal subspace: 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal kernel weights (cv): num [1:8] 1.0045 -0.6689 -0.0938 0.8499 0.0228 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span><span class="co"># Obtain summary of model object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spectral(df_numerator = numerator_small, df_denominator = denominator_small)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kernel type: Gaussian with L2 norm distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of kernels: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal sigma: 3.582214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal subspace: 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal kernel weights (cv): num [1:8] 1.0045 -0.6689 -0.0938 0.8499 0.0228 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pearson divergence between P(nu) and P(de): 0.8063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For a two-sample homogeneity test, use 'summary(x, test = TRUE)'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Plot model object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative estimated density ratios for 22 observation(s) converted to 0.01 before applying logarithmic transformation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="r-plt img"><img src="dr.histogram-22.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Plot density ratio for each variable individually</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_univariate.html">plot_univariate</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative estimated density ratios for 22 observation(s) converted to 0.01 before applying logarithmic transformation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="dr.histogram-23.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="dr.histogram-24.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-plt img"><img src="dr.histogram-25.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Plot density ratio for each pair of variables</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_bivariate.html">plot_bivariate</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative estimated density ratios for 22 observation(s) converted to 0.01 before applying logarithmic transformation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="dr.histogram-26.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="dr.histogram-27.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-plt img"><img src="dr.histogram-28.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Predict density ratio and inspect first 6 predictions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.8779372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 3.8658889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 3.7674156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 4.8603842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.6970124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 2.1671079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Fit model with custom parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="spectral.html">spectral</a></span><span class="op">(</span><span class="va">numerator_small</span>, <span class="va">denominator_small</span>, sigma <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spectral(df_numerator = numerator_small, df_denominator = denominator_small,     sigma = 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kernel type: Gaussian with L2 norm distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of kernels: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sigma: num 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Subspace dimension (J): num [1:50] 1 2 4 6 8 10 11 13 15 17 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal sigma: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal subspace: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal kernel weights (cv): num [1:4] 0.98 -0.8324 -0.0561 0.6471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Fit model (minimal example to limit computation time)</span></span></span>
<span class="r-in"><span><span class="va">dr</span> <span class="op">&lt;-</span> <span class="fu"><a href="lhss.html">lhss</a></span><span class="op">(</span><span class="va">numerator_small</span>, <span class="va">denominator_small</span>,</span></span>
<span class="r-in"><span>           nsigma <span class="op">=</span> <span class="fl">5</span>, nlambda <span class="op">=</span> <span class="fl">3</span>, ncenters <span class="op">=</span> <span class="fl">50</span>, maxit <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Inspect model object</span></span></span>
<span class="r-in"><span><span class="va">dr</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lhss(df_numerator = numerator_small, df_denominator = denominator_small,     nsigma = 5, nlambda = 3, ncenters = 50, maxit = 100)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kernel type: Gaussian with L2 norm distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of kernels: 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sigma: num [1:5, 1:3] 0.00952 0.36681 1.30318 3.4202 10.53644 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization parameter (lambda): num [1:3] 1e+03 1e+00 1e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Subspace dimension (m): 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal sigma: 0.3841266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal lambda: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal kernel weights (loocv): num [1:51] 0.2707 0.0121 0.097 0.0135 0.0836 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span><span class="co"># Obtain summary of model object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lhss(df_numerator = numerator_small, df_denominator = denominator_small,     nsigma = 5, nlambda = 3, ncenters = 50, maxit = 100)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kernel type: Gaussian with L2 norm distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of kernels: 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Subspace dimension (m): 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal sigma: 0.3841266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal lambda: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal kernel weights (loocv): num [1:51] 0.2707 0.0121 0.097 0.0135 0.0836 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pearson divergence between P(nu) and P(de): 0.2529</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For a two-sample homogeneity test, use 'summary(x, test = TRUE)'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Plot model object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="r-plt img"><img src="dr.histogram-29.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Plot density ratio for each variable individually</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_univariate.html">plot_univariate</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="dr.histogram-30.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="dr.histogram-31.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-plt img"><img src="dr.histogram-32.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Plot density ratio for each pair of variables</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_bivariate.html">plot_bivariate</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="dr.histogram-33.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="dr.histogram-34.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-plt img"><img src="dr.histogram-35.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Predict density ratio and inspect first 6 predictions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.8873535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 1.0458496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.8122089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.4962786</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 1.3122394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 1.3092069</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Fit model</span></span></span>
<span class="r-in"><span><span class="va">dr</span> <span class="op">&lt;-</span> <span class="fu"><a href="naive.html">naive</a></span><span class="op">(</span><span class="va">numerator_small</span>, <span class="va">denominator_small</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Inspect model object</span></span></span>
<span class="r-in"><span><span class="va">dr</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> naive(df_numerator = numerator_small, df_denominator = denominator_small)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Naive density ratio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of variables: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of numerator samples: 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of denominator samples: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Numerator density: num [1:50] 1.41 5.74 1.87 4.13 1.67 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Denominator density: num [1:100] 2.93 0.071 1.065 1.59 2.115 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span><span class="co"># Obtain summary of model object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> naive(df_numerator = numerator_small, df_denominator = denominator_small)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Naive density ratio estimate:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of variables: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of numerator samples: 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of denominator samples: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Density ratio for numerator samples: num [1:50] 0.344 1.747 0.628 1.419 0.511 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Density ratio for denominator samples: num [1:100] 1.0751 -2.6454 0.0626 0.464 0.7493 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Squared average log density ratio difference for numerator and denominator samples (SALDRD): 13.56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For a two-sample homogeneity test, use 'summary(x, test = TRUE)'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Plot model object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative estimated density ratios for 25 observation(s) converted to 0.01 before applying logarithmic transformation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="r-plt img"><img src="dr.histogram-36.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Plot density ratio for each variable individually</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_univariate.html">plot_univariate</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative estimated density ratios for 25 observation(s) converted to 0.01 before applying logarithmic transformation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="dr.histogram-37.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="dr.histogram-38.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-plt img"><img src="dr.histogram-39.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Plot density ratio for each pair of variables</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_bivariate.html">plot_bivariate</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative estimated density ratios for 25 observation(s) converted to 0.01 before applying logarithmic transformation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="dr.histogram-40.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="dr.histogram-41.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-plt img"><img src="dr.histogram-42.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Predict density ratio and inspect first 6 predictions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.410607 5.739287 1.874031 4.131255 1.666760 4.095855</span>
<span class="r-in"><span><span class="co"># Fit model with custom parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="naive.html">naive</a></span><span class="op">(</span><span class="va">numerator_small</span>, <span class="va">denominator_small</span>, m<span class="op">=</span><span class="fl">2</span>, kernel<span class="op">=</span><span class="st">"epanechnikov"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> naive(df_numerator = numerator_small, df_denominator = denominator_small,     m = 2, kernel = "epanechnikov")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Naive density ratio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of variables: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of numerator samples: 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of denominator samples: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Numerator density: num [1:50] 0.572 1.421 0.945 1.058 0.936 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Denominator density: num [1:100] 1.391 1.459 0.572 0.943 1.314 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thom Volker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

